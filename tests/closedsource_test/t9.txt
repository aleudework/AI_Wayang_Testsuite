USER_REQUEST: Create a Wayang plan that finds all the purchases in the household appliances file for purchases made in october 2025. It should only include purchases for organisation which have more than 10 departments, also return the creditor name of these purchases as well as the price and the purchase line. Output in a textfile. 
SQL_QUERY:
SELECT 
    fp.*,
    c.name AS creditor_name
FROM factpurchases fp
JOIN (
    SELECT organisation_id
    FROM department
    GROUP BY organisation_id
    HAVING COUNT(*) > 10
) d ON fp.organisation_id = d.organisation_id
JOIN creditor c
    ON fp.creditor_id = c.creditor_id
WHERE fp.invoice_date BETWEEN '2025-10-01' AND '2025-10-31'
  AND (
        fp.invoice_line_descr ILIKE '%Håndvask%' OR
        fp.invoice_line_descr ILIKE '%Komfur%' OR
        fp.invoice_line_descr ILIKE '%Ovn%'
      )
LIMIT 100;

OUTPUT:
organisation_id,department_id,creditor_id,invoice_id,invoice_date,invoice_line_no,invoice_line_descr,invoice_line_price,creditor_name
29,458,207119,1007240,2025-10-28,6,"632A - Ribberadiatorer/golfovne vask til ren bund inkl. aftørring",27.25,"Hjalthor Danmark ApS - 507021"
29,458,207119,1007240,2025-10-28,7,"822B - Komfur flader under, bag og omkring afvaskes",66.26,"Hjalthor Danmark ApS - 507021"
29,458,207119,1007240,2025-10-28,16,"835B - Håndvask afkalkning",24.14,"Hjalthor Danmark ApS - 507021"
29,459,194767,1004300,2025-10-21,10,"HUS60 Ovnskab 1 skuffe af kunststof, 16 l kapacite",1451.94,"Vordingborg Køkkenet A/S - 283146"
29,459,194767,1004300,2025-10-21,53,"Levering af ovn. Bauknecht CTAR 8640IN",2100.00,"Vordingborg Køkkenet A/S - 283146"