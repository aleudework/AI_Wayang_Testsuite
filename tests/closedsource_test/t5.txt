USER_REQUEST: Create a Wayang plan that checks the total purchases in 2025 from creditors with "VVS" in their name. It must also be creditors that do not have "SLETTET" in their name. Output in descending. I want creditor_id, creditor name and total price of each in my output. Output in textfile.
SQL_QUERY:
SELECT 
    c.creditor_id,
    c.name AS creditor_name,
    SUM(fp.invoice_line_price) AS total_purchases_2025
FROM factpurchases fp
JOIN creditor c ON fp.creditor_id = c.creditor_id
WHERE 
    EXTRACT(YEAR FROM fp.invoice_date) = 2025
    AND c.name LIKE '%VVS%'          
    AND c.name NOT LIKE '%SLETTET%'  
GROUP BY c.creditor_id, c.name
ORDER BY total_purchases_2025 DESC;

OUTPUT:
creditor_id,creditor_name,total_purchases_2025
224799,"Dansk VVS ApS - 565176",16821132.57
194567,"Delfin VVS Aps - 278445",4296080.87
217386,"VVS-Installatør Poul Christensen A/S - 340130",3199948.21
208745,"Dehlsen & Sønner VVS A/S - 146451",1794863.54
194242,"VVS John Jensen A/S - 226181",1782668.34