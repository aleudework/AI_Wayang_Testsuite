USER_REQUEST: Create a Wayang plan that takes a text file containing organisation names, matches these names to the organisation table in the database, finds all departments belonging to those organisations, and counts how many “BS-opgave” tasks each operation center has. The plan must group results by operation_center and sort them in descending order. Output your result in a textfile.
SQL_QUERY:
SELECT 
    d.operation_center,
    COUNT(*) AS total_bs_opgaver
FROM facttasks ft
JOIN department d 
    ON ft.department_id = d.department_id
JOIN organisation o
    ON ft.organisation_id = o.organisation_id
WHERE o.name IN (
    'Asminderød Boligselskab',
    'Ballerup almennyttige Boligselskab',
    'Gladsaxe almennyttige Boligselskab',
    'Gørlev Boligselskab'
)
AND ft.task_type = 'BS-opgave'
GROUP BY d.operation_center
ORDER BY total_bs_opgaver DESC;

OUTPUT:
operation_center,total_bs_opgaver
"Samdrift Bytoften",105
"Værebro Park - Ejendomskontor",103
"Grantoften",98
"Søndergård Park",97
"Ved Fortet - Ejendomskontor",96