USER_REQUEST: Create a plan that summarizes all line items shipped before a cutoff date, defined as July 1st 1998 minus 90 days. The query must group the results by return flag and line status. For each group, calculate the total quantity, total extended price, average quantity, average extended price, and the number of rows. You don't need ordering or sortineg. The output must be in textfile.
SQL_QUERY:
SELECT
    l_returnflag,
    l_linestatus,
    SUM(l_quantity) AS sum_qty,
    SUM(l_extendedprice) AS sum_base_price,
    AVG(l_quantity) AS avg_qty,
    AVG(l_extendedprice) AS avg_price,
    COUNT(*) AS count_order
FROM
    lineitem
WHERE
    l_shipdate <= DATE '1998-07-01' - INTERVAL '90' DAY
GROUP BY
    l_returnflag,
    l_linestatus

OUTPUT:
l_returnflag l_linestatus sum_qty sum_base_price avg_qty avg_price count_order
"A" "F" 37734107.00 56586554400.73 25.5220058532573370 38273.129734621672 1478493
"N" "F" 991417.00 1487504710.38 25.5164719205229835 38284.467760848304 38854
"N" "O" 64974895.00 97456058257.40 25.5047254964842871 38254.621478408974 2547563
"R" "F" 37719753.00 56568041380.90 25.5057936126907707 38250.854626099657 1478870