USER_REQUEST: Find the top 100 customers who have placed large-volume orders, where a large order is defined as an order whose total quantity exceeds 300. For each qualifying order, return the customer name, customer key, order key, order date, total price, and the total quantity of the order. Sort by total price desc. Output the results to a textfile.SQL_QUERY:
SELECT
    c.c_name,
    c.c_custkey,
    o.o_orderkey,
    o.o_orderdate,
    o.o_totalprice,
    SUM(l.l_quantity) AS total_quantity
FROM
    customer c
    JOIN orders o ON c.c_custkey = o.o_custkey
    JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE
    o.o_orderkey IN (
        SELECT
            l_orderkey
        FROM
            lineitem
        GROUP BY
            l_orderkey
        HAVING
            SUM(l_quantity) > 300
    )
GROUP BY
    c.c_name,
    c.c_custkey,
    o.o_orderkey,
    o.o_orderdate,
    o.o_totalprice
ORDER BY
    o.o_totalprice DESC
LIMIT 100;

OUTPUT:
c_name,c_custkey,o_orderkey,o_orderdate,o_totalprice,total_quantity
Customer#000128120,128120,4722021,1994-04-07,544089.09,323.00
Customer#000144617,144617,3043270,1997-02-12,530604.44,317.00
Customer#000013940,13940,2232932,1997-04-13,522720.61,304.00
Customer#000066790,66790,2199712,1996-09-30,515531.82,327.00
Customer#000046435,46435,4745607,1997-07-03,508047.99,309.00
Customer#000015272,15272,3883783,1993-07-28,500241.33,302.00
Customer#0000146608,146608,3342468,1994-06-12,499794.58,303.00