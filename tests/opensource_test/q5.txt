USER_REQUEST: Generate a Wayang plan for a query that calculates total revenue per nation within the region ‘EUROPE’. Revenue is defined as the sum of l_extendedprice * (1 - l_discount) for all lineitems where the customer and supplier belong to the same nation. Join the tables customer, orders, lineitem, supplier, nation, and region through their respective foreign keys. Only include orders placed in the year 1995. Filter for r_name = 'EUROPE'. Group the results by nation name and order the output by revenue in descending order. Output in textfile.
SELECT
    n_name,
    SUM(l_extendedprice * (1 - l_discount)) AS revenue
FROM
    customer,
    orders,
    lineitem,
    supplier,
    nation,
    region
WHERE
    c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND l_suppkey = s_suppkey
    AND c_nationkey = s_nationkey
    AND s_nationkey = n_nationkey
    AND n_regionkey = r_regionkey
    AND r_name = 'EUROPE'
    AND o_orderdate >= DATE '1995-01-01'
    AND o_orderdate < DATE '1996-01-01'
GROUP BY
    n_name
ORDER BY
    revenue DESC;


OUTPUT:
n_name,revenue
RUSSIA,56063022.8390
ROMANIA,54994648.5948
UNITED KINGDOM,54686147.4890
FRANCE,51941137.2334
GERMANY,51536498.1838
