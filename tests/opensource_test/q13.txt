USER_REQUEST: Find the distribution of customers based on how many orders they have placed. Include customers with zero orders. Ignore any orders whose comment contains the substring ‘special’ followed by ‘requests’. Count how many customers fall into each order-count group and output the number of customers per group. Sort by most orders. Output in textfile.
SQL_QUERY:
SELECT
    c_count,
    COUNT(*) AS custdist
FROM (
    SELECT
        c.c_custkey,
        COUNT(o.o_orderkey) AS c_count
    FROM
        customer c
        LEFT OUTER JOIN orders o
            ON c.c_custkey = o.o_custkey
            AND o.o_comment NOT LIKE '%special%requests%'
    GROUP BY
        c.c_custkey
) AS c_orders (c_custkey, c_count)
GROUP BY
    c_count
ORDER BY
    c_count DESC;

OUTPUT:
c_count,custdist
41,2
40,4
39,1
38,5
37,5
36,14
35,37